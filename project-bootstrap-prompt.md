# プロジェクト立ち上げ支援プロンプト

## ⚠️ 重要: このプロンプトの役割

**このプロンプト（`/ypm-new`コマンド）の唯一の仕事は、ブートストラップフローを厳格に守り、安全かつ迅速にプロジェクトの実装準備を完了させることです。**

### 絶対に守るべき原則

1. **ブートストラップフローの厳守**
   - Phase 1〜8を順番通りに実行
   - フェーズを飛ばさない、省略しない
   - ユーザーとの対話が必要な箇所は必ず確認

2. **実装は絶対に行わない**
   - YPMは準備のみ。実装・テストコード作成は禁止
   - 準備完了後、別セッションでの作業を案内

3. **進捗の可視化**
   - 各フェーズで現在地を明示
   ```
   ## [プロジェクト名] - ブートストラップ進捗

   ✅ Phase 1: プロジェクト企画
   ✅ Phase 2: プロジェクトディレクトリ作成
   🔄 Phase 3: ドキュメント整備 ← 現在ここ
   ⏳ Phase 4: GitHub連携
   ⏳ Phase 5: Git Workflow設定
   ⏳ Phase 6: 環境設定ファイル整備
   ⏳ Phase 7: ドキュメント管理ルール
   ⏳ Phase 8: CLAUDE.md作成と最終確認
   ```

4. **安全性の確保**
   - 破壊的操作を避ける
   - ユーザー確認箇所で必ず問いかける

5. **迅速性**
   - 効率的なヒアリング
   - テンプレート活用
   - 不要な対話は省く

---

新しいプロジェクトの企画から初期セットアップまでを段階的に進めます。

## フェーズ1: プロジェクト企画

まず、以下について対話しながら要件を固めていきます：

1. **プロジェクト概要のヒアリング**
   - どんなプロジェクトを作りたいですか？（目的、機能、技術スタック）
   - 対象ユーザーや利用シーン
   
2. **要件定義の作成**
   - 機能要件（必須機能、優先順位）
   - 非機能要件（パフォーマンス、セキュリティ、スケーラビリティ）
   - 技術選定の理由
   
3. **プロジェクト基本情報の決定**
   - プロジェクト名
   - 概要説明（短文・長文）
   - 使用言語・フレームワーク

要件定義がまとまったら、システム仕様書・アーキテクチャ図などの必要なドキュメントを作成します。

## フェーズ2: プロジェクトディレクトリの作成

1. **ローカルディレクトリの確認**
   - プロジェクト用のgitディレクトリのパスを教えてください
   - ディレクトリが存在しない場合は作成します
   
2. **Git初期化**
   - `git init` を実行
   - 初期コミット用のREADME.mdを作成

## フェーズ3: ドキュメント整備

1. **docs/ディレクトリの作成**
   - `docs/` 配下に以下を作成：
     - 要件定義書（requirements.md）
     - システム仕様書（specifications.md）
     - アーキテクチャ設計書（architecture.md）
     - 開発ガイドライン（development-guide.md）
   
2. **開発ルールの導入**
   - **DDD（Documentation Driven Development - ドキュメント駆動開発）**
     - **すべての開発はドキュメントから始まる**
     - 開発フロー：仕様書作成 → 実装 → テスト → ドキュメント更新
     - コードとドキュメントを常に同期
     - 新機能実装前に必ず`docs/development/`に仕様書を作成
     - ドキュメントが真実の唯一の源（Single Source of Truth）

   - **TDD（Test Driven Development - テスト駆動開発）**
     - Red → Green → Refactor サイクルの遵守
     - 実装前にテストを書く
     - テストカバレッジの目標設定

   - **DRY（Don't Repeat Yourself）**
     - コードの重複を避ける
     - 共通ロジックの抽出
     - 再利用可能なコンポーネント設計

3. **リサーチディレクトリの準備**
   - `docs/research/` を作成
   - README.mdに「将来的にサブレポジトリ化予定」と記載

## フェーズ4: GitHub連携

1. **GitHubアカウント情報の取得**
   - GitHubアカウント名を教えてください
   - `gh api user/orgs` で所属組織を取得・表示
   - 個人アカウントまたは組織を選択

2. **リポジトリ作成**
   - `gh repo create` でリポジトリ作成
   - 初期プッシュを実行

## フェーズ5: Git Workflowの設定

1. **Workflowの必要性確認**
   - Git Flowを導入しますか？（推奨：複数人開発の場合）

2. **導入する場合の設定**
   - デフォルトブランチを `develop` に設定
   - `main` と `develop` への直接プッシュを禁止
   - ブランチ保護ルール設定：
     - 必要なレビュワー数（一人プロジェクト: 0、チーム: 1）を確認

3. **Git Worktreeの導入確認**
   - Git Worktreeを導入しますか？
   - **導入する場合の構成**：
     - `main` worktree: 本番リリース用（読み取り専用）
     - `develop` worktree: 開発作業用（ここから開発ブランチを切る）
   - **導入しない場合**：
     - 通常のブランチ切り替えで運用
   - **注意**: 初期に導入しなくても、後から必要になったら導入可能

4. **作業フローのルール化**
   - 作業時は必ずISSUEを作成
   - 基本的に `develop` からブランチを切る
   - すでに作業用ブランチにいる場合は、どこからブランチを切るか確認

5. **コミット・PR・ISSUEの命名規則**
   - タイトル：英語
   - 本文：日本語または英語（どちらにしますか？）

## フェーズ6: 環境設定ファイルの整備

1. **.gitignoreの設定**
   - `.serena` を追加（開発プロジェクトで必須）
   - 言語・フレームワーク固有の設定を追加

2. **.claude/settings.json の設定**
   - Context7で公式ドキュメントをリサーチ：
     - Git, gh コマンドのパーミッション設定
     - Serenaのパーミッション設定
     - 一般的な操作のパーミッション設定
   - デフォルト戦略：
     - `allow`: 読み取り専用、プロジェクト内の安全な操作
     - `ask`: 書き込み操作、外部サービス連携
     - `deny`: システムファイル、プロジェクト外への破壊的変更
   
3. **破壊的変更の禁止ルール**
   - システムファイル（/etc, /usr など）への変更禁止
   - プロジェクトディレクトリ外のファイル変更禁止
   - これらをsettings.jsonとREADME.mdに明記

## フェーズ7: ドキュメント管理ルールの確立

1. **ドキュメント更新の原則**
   - **実装とドキュメントの同期維持**
     - 機能追加・変更時は関連ドキュメントも更新
     - PRレビュー時にドキュメント更新も確認
   
   - **更新が必要なタイミング**
     - 新機能の実装完了時
     - アーキテクチャの変更時
     - API仕様の変更時
     - 環境設定の変更時
     - 依存パッケージの大幅な更新時
   
   - **対象ドキュメント**
     - README.md（セットアップ手順、使い方）
     - docs/specifications.md（システム仕様）
     - docs/architecture.md（設計図）
     - docs/development-guide.md（開発ガイドライン）
     - API仕様書（存在する場合）

2. **オンボーディング支援**
   - README.mdに以下を含める：
     - クイックスタートガイド
     - 開発環境のセットアップ手順
     - よくある問題とその解決方法（FAQ）
     - コントリビューションガイドライン
   
   - `docs/onboarding.md` の作成：
     - プロジェクト構造の説明
     - コーディング規約
     - テストの書き方・実行方法
     - デプロイメントプロセス

3. **ドキュメント更新のチェックリスト**
   - PRテンプレートに「ドキュメント更新の有無」を追加
   - CI/CDでドキュメントのリンク切れチェック（可能な場合）

## フェーズ8: 最終確認

1. **追加ルールの確認**
   - 他に導入したいルールや設定はありますか？
   
2. **最終コミット・プッシュ**
   - すべての変更をコミット
   - GitHubにプッシュ
   
3. **セットアップ完了確認**
   - プロジェクトが開発可能な状態であることを確認
   - 次のステップの案内：
     - TDDサイクルでの開発開始
     - 最初のISSUE作成
     - 開発ブランチの切り方

---

## 開発中の継続的な実践

### TDD実践ルール
1. **Red**: 失敗するテストを書く
2. **Green**: テストをパスする最小限のコードを書く
3. **Refactor**: DRY原則に基づいてリファクタリング

### ドキュメント更新のトリガー
- 機能実装が完了し、PRをマージする直前
- マイルストーン達成時（v0.1.0, v0.2.0など）
- 月次または隔週での定期レビュー

---

## 使い方

このプロンプトをClaude Codeに貼り付けて、対話を開始してください。各フェーズで必要な情報を尋ねながら、段階的にプロジェクトをセットアップしていきます。

---

**主な追加点：**

1. **フェーズ3**にTDD・DRY原則の明記
2. **フェーズ7**として「ドキュメント管理ルール」を新設
   - 更新タイミングの明確化
   - オンボーディング支援の仕組み
   - チェックリストの導入
3. **フェーズ8**に開発開始時の指針を追加
4. **開発中の継続的な実践**セクションで実装中のルールを明記

これにより、プロジェクト開始時だけでなく、開発が進行する中でもドキュメントが最新に保たれ、新しいメンバーがいつでもスムーズに参加できる環境が整います。